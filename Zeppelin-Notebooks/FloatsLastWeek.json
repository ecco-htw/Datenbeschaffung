{"paragraphs":[{"text":"import org.apache.spark.sql._\nimport org.apache.spark.sql.types._\nimport scala.util.Try\nimport org.dia.core.SciSparkContext\nimport org.dia.loaders.NetCDFReader\nimport org.dia.utils.NetCDFUtils\nimport ucar.nc2._\nimport spark.implicits._\nval ssc = new SciSparkContext(sc)","user":"anonymous","dateUpdated":"2018-10-16T21:34:35+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql._\nimport org.apache.spark.sql.types._\nimport scala.util.Try\nimport org.dia.core.SciSparkContext\nimport org.dia.loaders.NetCDFReader\nimport org.dia.utils.NetCDFUtils\nimport ucar.nc2._\nimport spark.implicits._\nssc: org.dia.core.SciSparkContext = org.dia.core.SciSparkContext@28fbcd3c\n"}]},"apps":[],"jobName":"paragraph_1539718459624_1261252040","id":"20181016-213419_77849833","dateCreated":"2018-10-16T21:34:19+0200","dateStarted":"2018-10-16T21:34:31+0200","dateFinished":"2018-10-16T21:34:33+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8684"},{"text":"val fetchedTXT = sc.wholeTextFiles(\"ftp://anonymous:test@ftp.ifremer.fr/ifremer/argo/ar_index_this_week_prof.txt\")","user":"anonymous","dateUpdated":"2018-10-16T21:35:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"fetchedTXT: org.apache.spark.rdd.RDD[(String, String)] = ftp://anonymous:test@ftp.ifremer.fr/ifremer/argo/ar_index_this_week_prof.txt MapPartitionsRDD[15] at wholeTextFiles at <console>:80\n"}]},"apps":[],"jobName":"paragraph_1539718471520_2068225491","id":"20181016-213431_2055827297","dateCreated":"2018-10-16T21:34:31+0200","dateStarted":"2018-10-16T21:35:09+0200","dateFinished":"2018-10-16T21:35:10+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8685"},{"text":"val fullString = fetchedTXT.take(1)(0)._2\nval rowArray = fullString.split(\"\\n\")\n\n// EXTRACT SCHEMA\nval schemaString = rowArray.zipWithIndex.view.filter(row => row._1.charAt(0) != '#').head\nval schemaArray = schemaString._1.split(\",\")\nval schema = StructType( schemaArray.map(fieldName => StructField(fieldName, StringType, true)))\n\nval fullArray = rowArray.drop(schemaString._2+1).map(row=>row.split(\",\"))","user":"anonymous","dateUpdated":"2018-10-16T21:35:26+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"fullString: String =\n\"# Title : Profile directory file of the Argo Global Data Assembly Center\n# Description : The directory file describes all individual profile files of the argo GDAC ftp site.\n# Project : ARGO\n# Format version : 2.0\n# Date of update : 20181016190302\n# FTP root number 1 : ftp://ftp.ifremer.fr/ifremer/argo/dac\n# FTP root number 2 : ftp://usgodae.org/pub/outgoing/argo/dac\n# GDAC node : CORIOLIS\nfile,date,latitude,longitude,ocean,profiler_type,institution,date_update\naoml/13857/profiles/R13857_001.nc,19970729200300,0.267,-16.032,A,845,AO,20181011180520\naoml/13857/profiles/R13857_002.nc,19970809192112,0.072,-17.659,A,845,AO,20181011180521\naoml/13857/profiles/R13857_003.nc,19970820184545,0.543,-19.622,A,845,AO,20181011180521\naoml/13857/profiles/R13857_004.nc,19970831193905...rowArray: Array[String] = Array(# Title : Profile directory file of the Argo Global Data Assembly Center, # Description : The directory file describes all individual profile files of the argo GDAC ftp site., # Project : ARGO, # Format version : 2.0, # Date of update : 20181016190302, # FTP root number 1 : ftp://ftp.ifremer.fr/ifremer/argo/dac, # FTP root number 2 : ftp://usgodae.org/pub/outgoing/argo/dac, # GDAC node : CORIOLIS, file,date,latitude,longitude,ocean,profiler_type,institution,date_update, aoml/13857/profiles/R13857_001.nc,19970729200300,0.267,-16.032,A,845,AO,20181011180520, aoml/13857/profiles/R13857_002.nc,19970809192112,0.072,-17.659,A,845,AO,20181011180521, aoml/13857/profiles/R13857_003.nc,19970820184545,0.543,-19.622,A,845,AO,20181011180521, aoml/13857/profiles/R13857...schemaString: (String, Int) = (file,date,latitude,longitude,ocean,profiler_type,institution,date_update,8)\nschemaArray: Array[String] = Array(file, date, latitude, longitude, ocean, profiler_type, institution, date_update)\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(file,StringType,true), StructField(date,StringType,true), StructField(latitude,StringType,true), StructField(longitude,StringType,true), StructField(ocean,StringType,true), StructField(profiler_type,StringType,true), StructField(institution,StringType,true), StructField(date_update,StringType,true))\nfullArray: Array[Array[String]] = Array(Array(aoml/13857/profiles/R13857_001.nc, 19970729200300, 0.267, -16.032, A, 845, AO, 20181011180520), Array(aoml/13857/profiles/R13857_002.nc, 19970809192112, 0.072, -17.659, A, 845, AO, 20181011180521), Array(aoml/13857/profiles/R13857_003.nc, 19970820184545, 0.543, -19.622, A, 845, AO, 20181011180521), Array(aoml/13857/profiles/R13857_004.nc, 19970831193905, 1.256, -20.521, A, 845, AO, 20181011180521), Array(aoml/13857/profiles/R13857_005.nc, 19970911185808, 0.720, -20.768, A, 845, AO, 20181011180521), Array(aoml/13857/profiles/R13857_006.nc, 19970922195702, 1.756, -21.566, A, 845, AO, 20181011180522), Array(aoml/13857/profiles/R13857_007.nc, 19971003191549, 2.595, -21.564, A, 845, AO, 20181011180522), Array(aoml/13857/profiles/R13857_008.nc, 19..."}]},"apps":[],"jobName":"paragraph_1539718509392_1818457678","id":"20181016-213509_818830199","dateCreated":"2018-10-16T21:35:09+0200","dateStarted":"2018-10-16T21:35:26+0200","dateFinished":"2018-10-16T21:35:33+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8686"},{"text":"val listRDD = sc.parallelize(fullArray).map(row => Row.fromSeq(row))\nval listDF = sqlContext.createDataFrame(listRDD, schema)","user":"anonymous","dateUpdated":"2018-10-16T21:35:51+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"listRDD: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[17] at map at <console>:90\nlistDF: org.apache.spark.sql.DataFrame = [file: string, date: string ... 6 more fields]\n"}]},"apps":[],"jobName":"paragraph_1539718526448_-411957952","id":"20181016-213526_20380882","dateCreated":"2018-10-16T21:35:26+0200","dateStarted":"2018-10-16T21:35:48+0200","dateFinished":"2018-10-16T21:35:49+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8687"},{"text":"listDF.limit(3).show()","user":"anonymous","dateUpdated":"2018-10-16T21:36:02+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------+--------+---------+-----+-------------+-----------+--------------+\n|                file|          date|latitude|longitude|ocean|profiler_type|institution|   date_update|\n+--------------------+--------------+--------+---------+-----+-------------+-----------+--------------+\n|aoml/13857/profil...|19970729200300|   0.267|  -16.032|    A|          845|         AO|20181011180520|\n|aoml/13857/profil...|19970809192112|   0.072|  -17.659|    A|          845|         AO|20181011180521|\n|aoml/13857/profil...|19970820184545|   0.543|  -19.622|    A|          845|         AO|20181011180521|\n+--------------------+--------------+--------+---------+-----+-------------+-----------+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1539718548644_1670836152","id":"20181016-213548_64859242","dateCreated":"2018-10-16T21:35:48+0200","dateStarted":"2018-10-16T21:36:02+0200","dateFinished":"2018-10-16T21:36:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8688"},{"text":"listDF.groupBy($\"institution\").count().show()","user":"anonymous","dateUpdated":"2018-10-16T21:36:11+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----+\n|institution|count|\n+-----------+-----+\n|         IF| 2609|\n|         ME|   71|\n|         IN|  145|\n|         KM|   44|\n|         CS| 1218|\n|         HZ|   81|\n|         BO|  141|\n|         KO|  780|\n|         JA|  177|\n|         AO|18664|\n+-----------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1539718562063_-556464272","id":"20181016-213602_365578119","dateCreated":"2018-10-16T21:36:02+0200","dateStarted":"2018-10-16T21:36:11+0200","dateFinished":"2018-10-16T21:36:13+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8689"},{"text":"listDF.select($\"file\").first.mkString","user":"anonymous","dateUpdated":"2018-10-16T21:36:42+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res65: String = aoml/13857/profiles/R13857_001.nc\n"}]},"apps":[],"jobName":"paragraph_1539718571518_-1506729970","id":"20181016-213611_1942201408","dateCreated":"2018-10-16T21:36:11+0200","dateStarted":"2018-10-16T21:36:42+0200","dateFinished":"2018-10-16T21:36:42+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8690"}],"name":"FloatsLastWeek","id":"2DVERQR9A","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}